<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lab3</title>
  </head>
  <style>
    body {
      margin: 0;
      padding: 0;
      display: flex;
    }
    #zad1 {
      width: 30%;
      /* border: 1px dotted black; */
    }

    #zad2{
      width: 70%;
      /* border: 1px dotted black; */
      display: flex;
      flex-direction: column;
    }

    #platform{
      height: 80vh;
      background: yellow;
    }

    #generator_wrapper{
      height: 20vh;
    }
  </style>
  <body>
    <div id="zad1">
      <ol id="list">
        <li>
          <input id="add_el_input" type="text" />
        </li>
      </ol>
    </div>

    <div id="zad2">
      <div id="platform">

      </div>
      <div id="generator_wrapper">
        <button id="generate_btn">Generuj klocek</button>

      </div>
    </div>

    <script>
      

      // logika dodawania nowego elementu
      const input = document.getElementById("add_el_input");
      const listEl = document.getElementById("list");
      input.addEventListener("keyup", (ev) => {
        if (ev.key === "Enter") {
          let el = document.createElement("li");
          el.innerText = input.value;
          el.setAttribute("draggable", "true");
          el.classList.add("droppable");
          el.id = uuidv4();
          var randomColor = Math.floor(Math.random() * 16777215).toString(16);
          el.style = "background: #" + randomColor;
          listEl.appendChild(el);
          input.value = "";
        }
      });

      // logika przesuwania elementÃ³w
      let dragged;
      let id;
      let index;
      let indexDrop;
      let list;

      document.addEventListener("dragstart", ({ target }) => {
        dragged = target;
        id = target.id;
        list = target.parentNode.children;
        for (let i = 0; i < list.length; i += 1) {
          if (list[i] === dragged) {
            index = i;
          }
        }
      });

      document.addEventListener("dragover", (event) => {
        event.preventDefault();
      });

      document.addEventListener("drop", ({ target }) => {
        if (target.className == "droppable" && target.id !== id) {
          dragged.remove(dragged);
          for (let i = 0; i < list.length; i += 1) {
            if (list[i] === target) {
              indexDrop = i;
            }
          }
          if (index > indexDrop) {
            target.before(dragged);
          } else {
            target.after(dragged);
          }
        }
      });

      function uuidv4() {
        return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>
          (
            c ^
            (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))
          ).toString(16)
        );
      }
    </script>
  </body>
</html>
